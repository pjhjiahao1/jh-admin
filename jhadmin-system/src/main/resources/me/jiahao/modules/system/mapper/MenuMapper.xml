<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="me.jiahao.modules.system.mapper.MenuMapper">

    <select id="getMenuForRole" resultType="me.jiahao.modules.system.entity.MenuEntity">
        select
        c.id,c.menu_code,c.menu_name,c.menu_pid,c.permission,c.is_leaf,c.level,c.sort,c.status,c.icon,c.url,c.component,c.create_time
         from sys_role a left join sys_role_menu b
        on a.id = b.role_id
        left join sys_menu c
        on b.menu_id = c.id
        where a.role_code in
        <foreach item="item" collection="list" separator="," open="(" close=")" index="">
            #{item}
        </foreach>
        GROUP BY c.id,c.menu_code,c.menu_name,c.menu_pid,c.permission,c.is_leaf,c.level,c.sort,c.status,c.icon,c.url,c.component
        order by c.level,c.sort
    </select>

    <select id="getMenuForParams" resultType="me.jiahao.modules.system.entity.MenuEntity">
        select
        id,
        menu_pid,
        is_leaf,
        menu_name,
        url,
        icon,
        sort,
        level,
        status,
        permission,
        menu_code,
        component
        from sys_menu
        <where>
            <if test="menuName != null and menuName != ''">
                and menu_name = #{menuName}
            </if>
            <if test="menuPid != null and menuPid != ''">
                and id = #{menuPid}
            </if>
        </where>
    </select>

</mapper>